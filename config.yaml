# ⚠️  DEVELOPMENT CONFIGURATION - DO NOT USE IN PRODUCTION
# This configuration uses TEST KEYS that are publicly known.
# For production deployment, use config.production.yaml as a template.
#
# To use this config for local development/testing:
#   FASTGATE_ALLOW_TEST_KEYS=true ./fastgate
#
# To generate production secrets:
#   openssl rand -base64 32

version: v1
server:
  listen: ":8080"
  read_timeout_ms: 5000
  write_timeout_ms: 5000

  # DEVELOPMENT: No trusted proxies (unsafe, allows IP spoofing)
  # Production: Configure your load balancer subnets
  # trusted_proxies:
  #   - "10.0.0.0/8"

cookie:
  name: "Clearance"
  same_site: "Lax"
  max_age_sec: 3600
  secure: false  # DEVELOPMENT ONLY: Must be true in production
  http_only: true

modes:
  enforce: true
  fail_open: false
  under_attack: false

proxy:
  enabled: true
  mode: "integrated"
  origin: "http://localhost:3000"
  
  challenge_path: "/__uam"
  timeout_ms: 30000
  idle_timeout_ms: 90000

challenge:
  difficulty_bits: 12  # Low difficulty for development (use 16+ in production)
  ttl_sec: 60
  max_retries: 3
  nonce_rps_limit: 5.0
  retry_after_sec: 2

webauthn:
  enabled: true
  rp_id: "localhost"
  rp_name: "MeSH System Access"
  rp_origins: 
    - "http://localhost:8080"
  ttl_sec: 60

token:
  alg: "HS256"
  keys:
    # ⚠️  TEST KEY - Publicly known, DO NOT use in production
    v1: "dGhpc2lzYXRlc3RrZXlkb25vdHVzZWlucHJvZHVjdGlvbg"
  current_kid: "v1"
  issuer: "fastgate"

policy:
  challenge_threshold: 0  
  block_threshold: 100
  paths: []
  ws_concurrency_limits:
    per_ip: 10
    per_token: 10

cluster:
  enabled: true
  # ⚠️  TEST KEY - Publicly known, DO NOT use in production
  secret_key: "dGhpc2lzYXRlc3RrZXlkb25vdHVzZWlucHJvZHVjdGlvbg"

logging:
  level: "debug"